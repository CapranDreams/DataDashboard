{
  "version": 3,
  "sources": ["../../../../../node_modules/@ffmpeg/ffmpeg/dist/esm/const.js", "../../../../../node_modules/@ffmpeg/ffmpeg/dist/esm/utils.js", "../../../../../node_modules/@ffmpeg/ffmpeg/dist/esm/errors.js", "../../../../../node_modules/@ffmpeg/ffmpeg/dist/esm/classes.js"],
  "sourcesContent": ["export const MIME_TYPE_JAVASCRIPT = \"text/javascript\";\nexport const MIME_TYPE_WASM = \"application/wasm\";\nexport const CORE_VERSION = \"0.12.6\";\nexport const CORE_URL = `https://unpkg.com/@ffmpeg/core@${CORE_VERSION}/dist/umd/ffmpeg-core.js`;\nexport var FFMessageType;\n(function (FFMessageType) {\n    FFMessageType[\"LOAD\"] = \"LOAD\";\n    FFMessageType[\"EXEC\"] = \"EXEC\";\n    FFMessageType[\"WRITE_FILE\"] = \"WRITE_FILE\";\n    FFMessageType[\"READ_FILE\"] = \"READ_FILE\";\n    FFMessageType[\"DELETE_FILE\"] = \"DELETE_FILE\";\n    FFMessageType[\"RENAME\"] = \"RENAME\";\n    FFMessageType[\"CREATE_DIR\"] = \"CREATE_DIR\";\n    FFMessageType[\"LIST_DIR\"] = \"LIST_DIR\";\n    FFMessageType[\"DELETE_DIR\"] = \"DELETE_DIR\";\n    FFMessageType[\"ERROR\"] = \"ERROR\";\n    FFMessageType[\"DOWNLOAD\"] = \"DOWNLOAD\";\n    FFMessageType[\"PROGRESS\"] = \"PROGRESS\";\n    FFMessageType[\"LOG\"] = \"LOG\";\n    FFMessageType[\"MOUNT\"] = \"MOUNT\";\n    FFMessageType[\"UNMOUNT\"] = \"UNMOUNT\";\n})(FFMessageType || (FFMessageType = {}));\n", "/**\n * Generate an unique message ID.\n */\nexport const getMessageID = (() => {\n    let messageID = 0;\n    return () => messageID++;\n})();\n", "export const ERROR_UNKNOWN_MESSAGE_TYPE = new Error(\"unknown message type\");\nexport const ERROR_NOT_LOADED = new Error(\"ffmpeg is not loaded, call `await ffmpeg.load()` first\");\nexport const ERROR_TERMINATED = new Error(\"called FFmpeg.terminate()\");\nexport const ERROR_IMPORT_FAILURE = new Error(\"failed to import ffmpeg-core.js\");\n", "import { FFMessageType } from \"./const.js\";\nimport { getMessageID } from \"./utils.js\";\nimport { ERROR_TERMINATED, ERROR_NOT_LOADED } from \"./errors.js\";\n/**\n * Provides APIs to interact with ffmpeg web worker.\n *\n * @example\n * ```ts\n * const ffmpeg = new FFmpeg();\n * ```\n */\nexport class FFmpeg {\n    #worker = null;\n    /**\n     * #resolves and #rejects tracks Promise resolves and rejects to\n     * be called when we receive message from web worker.\n     */\n    #resolves = {};\n    #rejects = {};\n    #logEventCallbacks = [];\n    #progressEventCallbacks = [];\n    loaded = false;\n    /**\n     * register worker message event handlers.\n     */\n    #registerHandlers = () => {\n        if (this.#worker) {\n            this.#worker.onmessage = ({ data: { id, type, data }, }) => {\n                switch (type) {\n                    case FFMessageType.LOAD:\n                        this.loaded = true;\n                        this.#resolves[id](data);\n                        break;\n                    case FFMessageType.MOUNT:\n                    case FFMessageType.UNMOUNT:\n                    case FFMessageType.EXEC:\n                    case FFMessageType.WRITE_FILE:\n                    case FFMessageType.READ_FILE:\n                    case FFMessageType.DELETE_FILE:\n                    case FFMessageType.RENAME:\n                    case FFMessageType.CREATE_DIR:\n                    case FFMessageType.LIST_DIR:\n                    case FFMessageType.DELETE_DIR:\n                        this.#resolves[id](data);\n                        break;\n                    case FFMessageType.LOG:\n                        this.#logEventCallbacks.forEach((f) => f(data));\n                        break;\n                    case FFMessageType.PROGRESS:\n                        this.#progressEventCallbacks.forEach((f) => f(data));\n                        break;\n                    case FFMessageType.ERROR:\n                        this.#rejects[id](data);\n                        break;\n                }\n                delete this.#resolves[id];\n                delete this.#rejects[id];\n            };\n        }\n    };\n    /**\n     * Generic function to send messages to web worker.\n     */\n    #send = ({ type, data }, trans = [], signal) => {\n        if (!this.#worker) {\n            return Promise.reject(ERROR_NOT_LOADED);\n        }\n        return new Promise((resolve, reject) => {\n            const id = getMessageID();\n            this.#worker && this.#worker.postMessage({ id, type, data }, trans);\n            this.#resolves[id] = resolve;\n            this.#rejects[id] = reject;\n            signal?.addEventListener(\"abort\", () => {\n                reject(new DOMException(`Message # ${id} was aborted`, \"AbortError\"));\n            }, { once: true });\n        });\n    };\n    on(event, callback) {\n        if (event === \"log\") {\n            this.#logEventCallbacks.push(callback);\n        }\n        else if (event === \"progress\") {\n            this.#progressEventCallbacks.push(callback);\n        }\n    }\n    off(event, callback) {\n        if (event === \"log\") {\n            this.#logEventCallbacks = this.#logEventCallbacks.filter((f) => f !== callback);\n        }\n        else if (event === \"progress\") {\n            this.#progressEventCallbacks = this.#progressEventCallbacks.filter((f) => f !== callback);\n        }\n    }\n    /**\n     * Loads ffmpeg-core inside web worker. It is required to call this method first\n     * as it initializes WebAssembly and other essential variables.\n     *\n     * @category FFmpeg\n     * @returns `true` if ffmpeg core is loaded for the first time.\n     */\n    load = ({ classWorkerURL, ...config } = {}, { signal } = {}) => {\n        if (!this.#worker) {\n            this.#worker = classWorkerURL ?\n                new Worker(new URL(classWorkerURL, import.meta.url), {\n                    type: \"module\",\n                }) :\n                // We need to duplicated the code here to enable webpack\n                // to bundle worekr.js here.\n                new Worker(new URL(\"./worker.js\", import.meta.url), {\n                    type: \"module\",\n                });\n            this.#registerHandlers();\n        }\n        return this.#send({\n            type: FFMessageType.LOAD,\n            data: config,\n        }, undefined, signal);\n    };\n    /**\n     * Execute ffmpeg command.\n     *\n     * @remarks\n     * To avoid common I/O issues, [\"-nostdin\", \"-y\"] are prepended to the args\n     * by default.\n     *\n     * @example\n     * ```ts\n     * const ffmpeg = new FFmpeg();\n     * await ffmpeg.load();\n     * await ffmpeg.writeFile(\"video.avi\", ...);\n     * // ffmpeg -i video.avi video.mp4\n     * await ffmpeg.exec([\"-i\", \"video.avi\", \"video.mp4\"]);\n     * const data = ffmpeg.readFile(\"video.mp4\");\n     * ```\n     *\n     * @returns `0` if no error, `!= 0` if timeout (1) or error.\n     * @category FFmpeg\n     */\n    exec = (\n    /** ffmpeg command line args */\n    args, \n    /**\n     * milliseconds to wait before stopping the command execution.\n     *\n     * @defaultValue -1\n     */\n    timeout = -1, { signal } = {}) => this.#send({\n        type: FFMessageType.EXEC,\n        data: { args, timeout },\n    }, undefined, signal);\n    /**\n     * Terminate all ongoing API calls and terminate web worker.\n     * `FFmpeg.load()` must be called again before calling any other APIs.\n     *\n     * @category FFmpeg\n     */\n    terminate = () => {\n        const ids = Object.keys(this.#rejects);\n        // rejects all incomplete Promises.\n        for (const id of ids) {\n            this.#rejects[id](ERROR_TERMINATED);\n            delete this.#rejects[id];\n            delete this.#resolves[id];\n        }\n        if (this.#worker) {\n            this.#worker.terminate();\n            this.#worker = null;\n            this.loaded = false;\n        }\n    };\n    /**\n     * Write data to ffmpeg.wasm.\n     *\n     * @example\n     * ```ts\n     * const ffmpeg = new FFmpeg();\n     * await ffmpeg.load();\n     * await ffmpeg.writeFile(\"video.avi\", await fetchFile(\"../video.avi\"));\n     * await ffmpeg.writeFile(\"text.txt\", \"hello world\");\n     * ```\n     *\n     * @category File System\n     */\n    writeFile = (path, data, { signal } = {}) => {\n        const trans = [];\n        if (data instanceof Uint8Array) {\n            trans.push(data.buffer);\n        }\n        return this.#send({\n            type: FFMessageType.WRITE_FILE,\n            data: { path, data },\n        }, trans, signal);\n    };\n    mount = (fsType, options, mountPoint) => {\n        const trans = [];\n        return this.#send({\n            type: FFMessageType.MOUNT,\n            data: { fsType, options, mountPoint },\n        }, trans);\n    };\n    unmount = (mountPoint) => {\n        const trans = [];\n        return this.#send({\n            type: FFMessageType.UNMOUNT,\n            data: { mountPoint },\n        }, trans);\n    };\n    /**\n     * Read data from ffmpeg.wasm.\n     *\n     * @example\n     * ```ts\n     * const ffmpeg = new FFmpeg();\n     * await ffmpeg.load();\n     * const data = await ffmpeg.readFile(\"video.mp4\");\n     * ```\n     *\n     * @category File System\n     */\n    readFile = (path, \n    /**\n     * File content encoding, supports two encodings:\n     * - utf8: read file as text file, return data in string type.\n     * - binary: read file as binary file, return data in Uint8Array type.\n     *\n     * @defaultValue binary\n     */\n    encoding = \"binary\", { signal } = {}) => this.#send({\n        type: FFMessageType.READ_FILE,\n        data: { path, encoding },\n    }, undefined, signal);\n    /**\n     * Delete a file.\n     *\n     * @category File System\n     */\n    deleteFile = (path, { signal } = {}) => this.#send({\n        type: FFMessageType.DELETE_FILE,\n        data: { path },\n    }, undefined, signal);\n    /**\n     * Rename a file or directory.\n     *\n     * @category File System\n     */\n    rename = (oldPath, newPath, { signal } = {}) => this.#send({\n        type: FFMessageType.RENAME,\n        data: { oldPath, newPath },\n    }, undefined, signal);\n    /**\n     * Create a directory.\n     *\n     * @category File System\n     */\n    createDir = (path, { signal } = {}) => this.#send({\n        type: FFMessageType.CREATE_DIR,\n        data: { path },\n    }, undefined, signal);\n    /**\n     * List directory contents.\n     *\n     * @category File System\n     */\n    listDir = (path, { signal } = {}) => this.#send({\n        type: FFMessageType.LIST_DIR,\n        data: { path },\n    }, undefined, signal);\n    /**\n     * Delete an empty directory.\n     *\n     * @category File System\n     */\n    deleteDir = (path, { signal } = {}) => this.#send({\n        type: FFMessageType.DELETE_DIR,\n        data: { path },\n    }, undefined, signal);\n}\n"],
  "mappings": ";;;;;AAEO,IAAM,eAAe;AACrB,IAAM,WAAW,kCAAkC,YAAY;AAC/D,IAAI;AAAA,CACV,SAAUA,gBAAe;AACtB,EAAAA,eAAc,MAAM,IAAI;AACxB,EAAAA,eAAc,MAAM,IAAI;AACxB,EAAAA,eAAc,YAAY,IAAI;AAC9B,EAAAA,eAAc,WAAW,IAAI;AAC7B,EAAAA,eAAc,aAAa,IAAI;AAC/B,EAAAA,eAAc,QAAQ,IAAI;AAC1B,EAAAA,eAAc,YAAY,IAAI;AAC9B,EAAAA,eAAc,UAAU,IAAI;AAC5B,EAAAA,eAAc,YAAY,IAAI;AAC9B,EAAAA,eAAc,OAAO,IAAI;AACzB,EAAAA,eAAc,UAAU,IAAI;AAC5B,EAAAA,eAAc,UAAU,IAAI;AAC5B,EAAAA,eAAc,KAAK,IAAI;AACvB,EAAAA,eAAc,OAAO,IAAI;AACzB,EAAAA,eAAc,SAAS,IAAI;AAC/B,GAAG,kBAAkB,gBAAgB,CAAC,EAAE;;;AClBjC,IAAM,eAAgB,uBAAM;AAC/B,MAAI,YAAY;AAChB,SAAO,MAAM;AACjB,GAAG;;;ACNI,IAAM,6BAA6B,IAAI,MAAM,sBAAsB;AACnE,IAAM,mBAAmB,IAAI,MAAM,wDAAwD;AAC3F,IAAM,mBAAmB,IAAI,MAAM,2BAA2B;AAC9D,IAAM,uBAAuB,IAAI,MAAM,iCAAiC;;;ACQxE,IAAM,SAAN,MAAa;AAAA,EAChB,UAAU;AAAA;AAAA;AAAA;AAAA;AAAA,EAKV,YAAY,CAAC;AAAA,EACb,WAAW,CAAC;AAAA,EACZ,qBAAqB,CAAC;AAAA,EACtB,0BAA0B,CAAC;AAAA,EAC3B,SAAS;AAAA;AAAA;AAAA;AAAA,EAIT,oBAAoB,MAAM;AACtB,QAAI,KAAK,SAAS;AACd,WAAK,QAAQ,YAAY,CAAC,EAAE,MAAM,EAAE,IAAI,MAAM,KAAK,EAAG,MAAM;AACxD,gBAAQ,MAAM;AAAA,UACV,KAAK,cAAc;AACf,iBAAK,SAAS;AACd,iBAAK,UAAU,EAAE,EAAE,IAAI;AACvB;AAAA,UACJ,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AAAA,UACnB,KAAK,cAAc;AACf,iBAAK,UAAU,EAAE,EAAE,IAAI;AACvB;AAAA,UACJ,KAAK,cAAc;AACf,iBAAK,mBAAmB,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC;AAC9C;AAAA,UACJ,KAAK,cAAc;AACf,iBAAK,wBAAwB,QAAQ,CAAC,MAAM,EAAE,IAAI,CAAC;AACnD;AAAA,UACJ,KAAK,cAAc;AACf,iBAAK,SAAS,EAAE,EAAE,IAAI;AACtB;AAAA,QACR;AACA,eAAO,KAAK,UAAU,EAAE;AACxB,eAAO,KAAK,SAAS,EAAE;AAAA,MAC3B;AAAA,IACJ;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAIA,QAAQ,CAAC,EAAE,MAAM,KAAK,GAAG,QAAQ,CAAC,GAAG,WAAW;AAC5C,QAAI,CAAC,KAAK,SAAS;AACf,aAAO,QAAQ,OAAO,gBAAgB;AAAA,IAC1C;AACA,WAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACpC,YAAM,KAAK,aAAa;AACxB,WAAK,WAAW,KAAK,QAAQ,YAAY,EAAE,IAAI,MAAM,KAAK,GAAG,KAAK;AAClE,WAAK,UAAU,EAAE,IAAI;AACrB,WAAK,SAAS,EAAE,IAAI;AACpB,cAAQ,iBAAiB,SAAS,MAAM;AACpC,eAAO,IAAI,aAAa,aAAa,EAAE,gBAAgB,YAAY,CAAC;AAAA,MACxE,GAAG,EAAE,MAAM,KAAK,CAAC;AAAA,IACrB,CAAC;AAAA,EACL;AAAA,EACA,GAAG,OAAO,UAAU;AAChB,QAAI,UAAU,OAAO;AACjB,WAAK,mBAAmB,KAAK,QAAQ;AAAA,IACzC,WACS,UAAU,YAAY;AAC3B,WAAK,wBAAwB,KAAK,QAAQ;AAAA,IAC9C;AAAA,EACJ;AAAA,EACA,IAAI,OAAO,UAAU;AACjB,QAAI,UAAU,OAAO;AACjB,WAAK,qBAAqB,KAAK,mBAAmB,OAAO,CAAC,MAAM,MAAM,QAAQ;AAAA,IAClF,WACS,UAAU,YAAY;AAC3B,WAAK,0BAA0B,KAAK,wBAAwB,OAAO,CAAC,MAAM,MAAM,QAAQ;AAAA,IAC5F;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQA,OAAO,CAAC,KAAgC,CAAC,GAAG,EAAE,OAAO,IAAI,CAAC,MAAM;AAAxD,iBAAE,iBApGd,IAoGY,IAAqB,mBAArB,IAAqB,CAAnB;AACN,QAAI,CAAC,KAAK,SAAS;AACf,WAAK,UAAU,iBACX,IAAI,OAAO,IAAI,IAAI,gBAAgB,YAAY,GAAG,GAAG;AAAA,QACjD,MAAM;AAAA,MACV,CAAC;AAAA;AAAA;AAAA,QAGD,IAAI,OAAO,IAAI,IAAI,eAAe,YAAY,GAAG,GAAG;AAAA,UAChD,MAAM;AAAA,QACV,CAAC;AAAA;AACL,WAAK,kBAAkB;AAAA,IAC3B;AACA,WAAO,KAAK,MAAM;AAAA,MACd,MAAM,cAAc;AAAA,MACpB,MAAM;AAAA,IACV,GAAG,QAAW,MAAM;AAAA,EACxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqBA,OAAO,CAEP,MAMA,UAAU,IAAI,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IACzC,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,MAAM,QAAQ;AAAA,EAC1B,GAAG,QAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOpB,YAAY,MAAM;AACd,UAAM,MAAM,OAAO,KAAK,KAAK,QAAQ;AAErC,eAAW,MAAM,KAAK;AAClB,WAAK,SAAS,EAAE,EAAE,gBAAgB;AAClC,aAAO,KAAK,SAAS,EAAE;AACvB,aAAO,KAAK,UAAU,EAAE;AAAA,IAC5B;AACA,QAAI,KAAK,SAAS;AACd,WAAK,QAAQ,UAAU;AACvB,WAAK,UAAU;AACf,WAAK,SAAS;AAAA,IAClB;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAcA,YAAY,CAAC,MAAM,MAAM,EAAE,OAAO,IAAI,CAAC,MAAM;AACzC,UAAM,QAAQ,CAAC;AACf,QAAI,gBAAgB,YAAY;AAC5B,YAAM,KAAK,KAAK,MAAM;AAAA,IAC1B;AACA,WAAO,KAAK,MAAM;AAAA,MACd,MAAM,cAAc;AAAA,MACpB,MAAM,EAAE,MAAM,KAAK;AAAA,IACvB,GAAG,OAAO,MAAM;AAAA,EACpB;AAAA,EACA,QAAQ,CAAC,QAAQ,SAAS,eAAe;AACrC,UAAM,QAAQ,CAAC;AACf,WAAO,KAAK,MAAM;AAAA,MACd,MAAM,cAAc;AAAA,MACpB,MAAM,EAAE,QAAQ,SAAS,WAAW;AAAA,IACxC,GAAG,KAAK;AAAA,EACZ;AAAA,EACA,UAAU,CAAC,eAAe;AACtB,UAAM,QAAQ,CAAC;AACf,WAAO,KAAK,MAAM;AAAA,MACd,MAAM,cAAc;AAAA,MACpB,MAAM,EAAE,WAAW;AAAA,IACvB,GAAG,KAAK;AAAA,EACZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAaA,WAAW,CAAC,MAQZ,WAAW,UAAU,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IAChD,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,MAAM,SAAS;AAAA,EAC3B,GAAG,QAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpB,aAAa,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IAC/C,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,KAAK;AAAA,EACjB,GAAG,QAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpB,SAAS,CAAC,SAAS,SAAS,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IACvD,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,SAAS,QAAQ;AAAA,EAC7B,GAAG,QAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpB,YAAY,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IAC9C,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,KAAK;AAAA,EACjB,GAAG,QAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpB,UAAU,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IAC5C,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,KAAK;AAAA,EACjB,GAAG,QAAW,MAAM;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAMpB,YAAY,CAAC,MAAM,EAAE,OAAO,IAAI,CAAC,MAAM,KAAK,MAAM;AAAA,IAC9C,MAAM,cAAc;AAAA,IACpB,MAAM,EAAE,KAAK;AAAA,EACjB,GAAG,QAAW,MAAM;AACxB;",
  "names": ["FFMessageType"]
}
